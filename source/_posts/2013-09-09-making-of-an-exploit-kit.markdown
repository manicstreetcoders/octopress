---
layout: post
title: "Making of an Exploit Kit"
date: 2013-09-09 15:26
comments: true
categories: 
---

Drive-by-download 공격을 수행하는 Exploit Kit 을 만들고 있다.

중국산 EK 들이 쓰는 CVE 들과 한국에 유독 많은 ActiveX 컨트롤들의 취약점을 활용할 예정.

Browser Fingerprinting 을 통해 적절한 Exploit 으로 대응한다.

몇가지 아이디어와 루틴들을 실험하기 위해 실험용 웹사이트를 셋업했다.

Browser 의 종류나 설치된 플러그인들의 버전은 deployJava.js, swfobject.js, PluginDetect.js 등을 활용하면,

거의 정확하게 판정이 가능하다. 즉 취약한 버전의 Java Runtime 이 있는지, 취약한 버전의 Flash Player 가 있는지를 거의 정확하게 판별할 수 있다는 것.

Applet 을 활용하면, virtual machine 인지를 확인도 가능한 듯 하다.

난독화는 나중에 하기로 했다.

[JavaScript Obfuscation Patterns](http://zomo.herokuapp.com/blog/2013/06/01/javascript-obfuscation-patterns/) 에 있는 패턴 뿐만 아니라, parsing tree 를 만들어서 obfuscate 하는 툴도 만들기로 했다.

들어오는 Traffic 의 10% 정도를 감염시킬 수 있으면, 꽤 준수하지 않을까 생각하고 있다.
