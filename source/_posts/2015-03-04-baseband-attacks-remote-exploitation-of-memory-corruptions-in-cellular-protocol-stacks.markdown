---
layout: post
title: "Baseband Attacks: Remote Exploitation of Memory Corruptions in Cellular Protocol Stacks"
date: 2015-03-04 11:13:38 +0900
comments: true
categories: 
---

Ralf-Philipp Weinmann 의 [Baseband Attacks: Remote Exploitation of Memory Corruptions in Cellular Protocol Stacks](https://www.usenix.org/system/files/conference/woot12/woot12-final24.pdf) 을 읽고 정리한다.

참고가 될 만한 다른 글들

* [Random tales from a mobile phone hacker, Collin Mulliner, CanSecWest 2010](http://www.mulliner.org/security/feed/random_tales_mobile_hacker.pdf)
* [SMS of Death: from analyzing to attacking mobile phones on a large scale](https://www.usenix.org/legacy/events/sec11/tech/full_papers/Mulliner.pdf)
* [Fuzzing the phone in your phone](http://www.mulliner.org/security/sms/feed/smsfuzz_26c3.pdf)
* [D5.3 Report on automated vulnerability discovery techniques](http://www.crisalis-project.eu/sites/crisalis-project.eu/files/crisalis_deliverable-D5.3.pdf)
* [SS7: Locate. Track. Manipulate.](http://berlin.ccc.de/~tobias/31c3-ss7-locate-track-manipulate.pdf)
* [Weaponizing Femtocells: The Effect of Rogue Devices on Mobile Telecommunication](http://www.tu-berlin.de/fileadmin/fg214/Papers/femto_ndss12.pdf)

#### Attack Scenario

* 타겟이 되는 MS 근처에 BTS (Base Transceiver Station) 을 설치한다.
* BTS 는 강한 signal 강도로 network 가 avail 하다고 계속 때린다.
* MS 가 가짜 BTS 에 연결된다.

#### GSM

* 3G Baseband 칩/스택을 파는 회사는 Qualcomm, Intel (formerly Infineon), Broadcom, Texas Instruments, ST-Ericsson, Renesas (formerly Nokia), Marvell, MediaTek, NVidia (formerly Icera), VIA Telecom, Spreadtrum, Samsung 정도

#### Previous Works

* AT command fuzzing
* SMS 로 DoS 공격 - Mulliner, Golde & Seifert
* SMS 로 RCE - BlackHat 2009 Miller & Mulliner

#### GSM 스택

#### Reverse-Engineering of the Firmware

* GSM 스택 소스는 라이센스를 받아야 얻을 수 있다.
* Vitelcom TSM30 프로젝트 소스코드가 공개된 적이 있는데, 거기 Condat GSM 스택 소스가 있었다.
* iPhone 4 용 업데이트 이미지에서 a full baseband binary blob 을 unpack 한후에 IDA Pro 와 BinDiff 를 이용해 분석.
* unltrasn0w - 
* wiki - 

#### Classification of bugs found

* Insufficient length checks  
* Object/structure lifecycle issues  
* Integer Overflows/underflows
* Memory information leaks

#### Examples of exploitable bugs found

* Sending a longer TMSI (e.g. 128 bytes) caused the baseband stack of iPhones with Intel/Comneon to crash
* For authentication, the base station transmits a challenge to the handset. In GSM, this challenge is a 16 byte value called RAND. For UMTS, a so-called AUTN challenge is used - which is encoded as a variable length in IE, but in fact is specified to also be 16 bytes long.
