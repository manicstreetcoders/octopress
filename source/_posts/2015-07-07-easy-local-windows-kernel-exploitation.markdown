---
layout: post
title: "Easy Local Windows Kernel Exploitation"
date: 2015-07-07 17:04:01 +0900
comments: true
categories: 
---

[Easy Local Windows Kernel Exploitation](https://media.blackhat.com/bh-us-12/Briefings/Cerrudo/BH_US_12_Cerrudo_Windows_Kernel_WP.pdf)

#### Nulling out ACLs

```
kd> dt nt!_OBJECT_HEADER
...
+0x014 SecurityDescriptor : Ptr32 Void 
+0x018 Body : _QUAD
```

1. NtQuerySystemInformation() 으로 target object 의 kernel 주소를 얻어낸다.
2. address - 4 (x86) or address - 8 (x64) 에다가 NULL 을 쓴다. (SecurityDescriptor 를 밀어버린다)
3. LSASS process 에 접근해서 hash 를 덤프한다.

#### SEP_TOKEN_PRIVILEGES 조작


#### EPROCESS 의 Token 구조체 조작
